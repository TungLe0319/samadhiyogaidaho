import{A as T,v as _,P as At}from"./index.c134cf15.js";var J=function(o,n){return J=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},J(o,n)};function y(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function t(){this.constructor=o}J(o,n),o.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var K=function(){return K=Object.assign||function(o){for(var n,t=1,e=arguments.length;t<e;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i]);return o},K.apply(this,arguments)};function w(o,n,t,e){return new(t||(t=Promise))(function(i,r){function s(l){try{c(e.next(l))}catch(u){r(u)}}function a(l){try{c(e.throw(l))}catch(u){r(u)}}function c(l){var u;l.done?i(l.value):(u=l.value,u instanceof t?u:new t(function(h){h(u)})).then(s,a)}c((e=e.apply(o,n||[])).next())})}function S(o,n){var t,e,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(c){return function(l){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,e&&(i=2&u[0]?e.return:u[0]?e.throw||((i=e.return)&&i.call(e),0):e.next)&&!(i=i.call(e,u[1])).done)return i;switch(e=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,e=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){s=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(u[0]===6&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=n.call(o,s)}catch(h){u=[6,h],e=0}finally{t=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([c,l])}}}var wt,U=function(o){function n(t){var e,i=this;return(i=o.call(this,"ClientResponseError")||this).url="",i.status=0,i.data={},i.isAbort=!1,i.originalError=null,Object.setPrototypeOf(i,n.prototype),t instanceof n||(i.originalError=t),t!==null&&typeof t=="object"&&(i.url=typeof t.url=="string"?t.url:"",i.status=typeof t.status=="number"?t.status:0,i.data=t.data!==null&&typeof t.data=="object"?t.data:{}),typeof DOMException<"u"&&t instanceof DOMException&&(i.isAbort=!0),i.name="ClientResponseError "+i.status,i.message=(e=i.data)===null||e===void 0?void 0:e.message,i.message||(i.message=i.isAbort?"The request was autocancelled. More info you could find in https://github.com/pocketbase/js-sdk#auto-cancellation.":"Something went wrong while processing your request."),i}return y(n,o),n.prototype.toJSON=function(){return K({},this)},n}(Error),D=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function dt(o,n,t){var e=Object.assign({},t||{}),i=e.encode||jt;if(!D.test(o))throw new TypeError("argument name is invalid");var r=i(n);if(r&&!D.test(r))throw new TypeError("argument val is invalid");var s=o+"="+r;if(e.maxAge!=null){var a=e.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");s+="; Max-Age="+Math.floor(a)}if(e.domain){if(!D.test(e.domain))throw new TypeError("option domain is invalid");s+="; Domain="+e.domain}if(e.path){if(!D.test(e.path))throw new TypeError("option path is invalid");s+="; Path="+e.path}if(e.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(e.expires)||isNaN(e.expires.valueOf()))throw new TypeError("option expires is invalid");s+="; Expires="+e.expires.toUTCString()}if(e.httpOnly&&(s+="; HttpOnly"),e.secure&&(s+="; Secure"),e.priority)switch(typeof e.priority=="string"?e.priority.toLowerCase():e.priority){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(e.sameSite)switch(typeof e.sameSite=="string"?e.sameSite.toLowerCase():e.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s}function Et(o){return o.indexOf("%")!==-1?decodeURIComponent(o):o}function jt(o){return encodeURIComponent(o)}function pt(o){if(o)try{var n=decodeURIComponent(wt(o.split(".")[1]).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)||{}}catch{}return{}}wt=typeof atob=="function"?atob:function(o){var n=String(o).replace(/=+$/,"");if(n.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,e,i=0,r=0,s="";e=n.charAt(r++);~e&&(t=i%4?64*t+e:e,i++%4)?s+=String.fromCharCode(255&t>>(-2*i&6)):0)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(e);return s};var B=function(){function o(n){n===void 0&&(n={}),this.load(n||{})}return o.prototype.load=function(n){for(var t=0,e=Object.entries(n);t<e.length;t++){var i=e[t],r=i[0],s=i[1];this[r]=s}this.id=n.id!==void 0?n.id:"",this.created=n.created!==void 0?n.created:"",this.updated=n.updated!==void 0?n.updated:""},Object.defineProperty(o.prototype,"isNew",{get:function(){return!this.id},enumerable:!1,configurable:!0}),o.prototype.clone=function(){return new this.constructor(JSON.parse(JSON.stringify(this)))},o.prototype.export=function(){return Object.assign({},this)},o}(),M=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.load=function(t){o.prototype.load.call(this,t),this.collectionId=typeof t.collectionId=="string"?t.collectionId:"",this.collectionName=typeof t.collectionName=="string"?t.collectionName:"",this.expand=typeof t.expand=="object"&&t.expand!==null?t.expand:{}},n}(B),V=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.load=function(t){o.prototype.load.call(this,t),this.avatar=typeof t.avatar=="number"?t.avatar:0,this.email=typeof t.email=="string"?t.email:""},n}(B),xt=function(){function o(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}return Object.defineProperty(o.prototype,"token",{get:function(){return this.baseToken},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"model",{get:function(){return this.baseModel},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"isValid",{get:function(){return!function(n,t){t===void 0&&(t=0);var e=pt(n);return!(Object.keys(e).length>0&&(!e.exp||e.exp-t>Date.now()/1e3))}(this.token)},enumerable:!1,configurable:!0}),o.prototype.save=function(n,t){this.baseToken=n||"",this.baseModel=t!==null&&typeof t=="object"?t.collectionId!==void 0?new M(t):new V(t):null,this.triggerChange()},o.prototype.clear=function(){this.baseToken="",this.baseModel=null,this.triggerChange()},o.prototype.loadFromCookie=function(n,t){t===void 0&&(t="pb_auth");var e=function(r,s){var a={};if(typeof r!="string")return a;for(var c=Object.assign({},s||{}).decode||Et,l=0;l<r.length;){var u=r.indexOf("=",l);if(u===-1)break;var h=r.indexOf(";",l);if(h===-1)h=r.length;else if(h<u){l=r.lastIndexOf(";",u-1)+1;continue}var f=r.slice(l,u).trim();if(a[f]===void 0){var p=r.slice(u+1,h).trim();p.charCodeAt(0)===34&&(p=p.slice(1,-1));try{a[f]=c(p)}catch{a[f]=p}}l=h+1}return a}(n||"")[t]||"",i={};try{(typeof(i=JSON.parse(e))===null||typeof i!="object"||Array.isArray(i))&&(i={})}catch{}this.save(i.token||"",i.model||null)},o.prototype.exportToCookie=function(n,t){var e,i,r;t===void 0&&(t="pb_auth");var s={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},a=pt(this.token);a!=null&&a.exp?s.expires=new Date(1e3*a.exp):s.expires=new Date("1970-01-01"),n=Object.assign({},s,n);var c={token:this.token,model:((e=this.model)===null||e===void 0?void 0:e.export())||null},l=dt(t,JSON.stringify(c),n),u=typeof Blob<"u"?new Blob([l]).size:l.length;return c.model&&u>4096&&(c.model={id:(i=c==null?void 0:c.model)===null||i===void 0?void 0:i.id,email:(r=c==null?void 0:c.model)===null||r===void 0?void 0:r.email},this.model instanceof M&&(c.model.username=this.model.username,c.model.verified=this.model.verified,c.model.collectionId=this.model.collectionId),l=dt(t,JSON.stringify(c),n)),l},o.prototype.onChange=function(n,t){var e=this;return t===void 0&&(t=!1),this._onChangeCallbacks.push(n),t&&n(this.token,this.model),function(){for(var i=e._onChangeCallbacks.length-1;i>=0;i--)if(e._onChangeCallbacks[i]==n)return delete e._onChangeCallbacks[i],void e._onChangeCallbacks.splice(i,1)}},o.prototype.triggerChange=function(){for(var n=0,t=this._onChangeCallbacks;n<t.length;n++){var e=t[n];e&&e(this.token,this.model)}},o}(),Lt=function(o){function n(t){t===void 0&&(t="pocketbase_auth");var e=o.call(this)||this;return e.storageFallback={},e.storageKey=t,e}return y(n,o),Object.defineProperty(n.prototype,"token",{get:function(){return(this._storageGet(this.storageKey)||{}).token||""},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"model",{get:function(){var t,e=this._storageGet(this.storageKey)||{};return e===null||typeof e!="object"||e.model===null||typeof e.model!="object"?null:((t=e.model)===null||t===void 0?void 0:t.collectionId)===void 0?new V(e.model):new M(e.model)},enumerable:!1,configurable:!0}),n.prototype.save=function(t,e){this._storageSet(this.storageKey,{token:t,model:e}),o.prototype.save.call(this,t,e)},n.prototype.clear=function(){this._storageRemove(this.storageKey),o.prototype.clear.call(this)},n.prototype._storageGet=function(t){if(typeof window<"u"&&(window==null?void 0:window.localStorage)){var e=window.localStorage.getItem(t)||"";try{return JSON.parse(e)}catch{return e}}return this.storageFallback[t]},n.prototype._storageSet=function(t,e){if(typeof window<"u"&&(window==null?void 0:window.localStorage)){var i=e;typeof e!="string"&&(i=JSON.stringify(e)),window.localStorage.setItem(t,i)}else this.storageFallback[t]=e},n.prototype._storageRemove=function(t){var e;typeof window<"u"&&(window==null?void 0:window.localStorage)&&((e=window.localStorage)===null||e===void 0||e.removeItem(t)),delete this.storageFallback[t]},n}(xt),F=function(o){this.client=o},Ut=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.getAll=function(t){return t===void 0&&(t={}),this.client.send("/api/settings",{method:"GET",params:t}).then(function(e){return e||{}})},n.prototype.update=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send("/api/settings",{method:"PATCH",params:e,body:t}).then(function(i){return i||{}})},n.prototype.testS3=function(t){return t===void 0&&(t={}),this.client.send("/api/settings/test/s3",{method:"POST",params:t}).then(function(){return!0})},n.prototype.testEmail=function(t,e,i){i===void 0&&(i={});var r={email:t,template:e};return this.client.send("/api/settings/test/email",{method:"POST",params:i,body:r}).then(function(){return!0})},n}(F),St=function(o,n,t,e,i){this.page=o>0?o:1,this.perPage=n>=0?n:0,this.totalItems=t>=0?t:0,this.totalPages=e>=0?e:0,this.items=i||[]},X=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.getFullList=function(t,e){return t===void 0&&(t=200),e===void 0&&(e={}),this._getFullList(this.baseCrudPath,t,e)},n.prototype.getList=function(t,e,i){return t===void 0&&(t=1),e===void 0&&(e=30),i===void 0&&(i={}),this._getList(this.baseCrudPath,t,e,i)},n.prototype.getFirstListItem=function(t,e){return e===void 0&&(e={}),this._getFirstListItem(this.baseCrudPath,t,e)},n.prototype.getOne=function(t,e){return e===void 0&&(e={}),this._getOne(this.baseCrudPath,t,e)},n.prototype.create=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this._create(this.baseCrudPath,t,e)},n.prototype.update=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),this._update(this.baseCrudPath,t,e,i)},n.prototype.delete=function(t,e){return e===void 0&&(e={}),this._delete(this.baseCrudPath,t,e)},n}(function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype._getFullList=function(t,e,i){var r=this;e===void 0&&(e=100),i===void 0&&(i={});var s=[],a=function(c){return w(r,void 0,void 0,function(){return S(this,function(l){return[2,this._getList(t,c,e,i).then(function(u){var h=u,f=h.items,p=h.totalItems;return s=s.concat(f),f.length&&p>s.length?a(c+1):s})]})})};return a(1)},n.prototype._getList=function(t,e,i,r){var s=this;return e===void 0&&(e=1),i===void 0&&(i=30),r===void 0&&(r={}),r=Object.assign({page:e,perPage:i},r),this.client.send(t,{method:"GET",params:r}).then(function(a){var c=[];if(a!=null&&a.items){a.items=a.items||[];for(var l=0,u=a.items;l<u.length;l++){var h=u[l];c.push(s.decode(h))}}return new St((a==null?void 0:a.page)||1,(a==null?void 0:a.perPage)||0,(a==null?void 0:a.totalItems)||0,(a==null?void 0:a.totalPages)||0,c)})},n.prototype._getOne=function(t,e,i){var r=this;return i===void 0&&(i={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"GET",params:i}).then(function(s){return r.decode(s)})},n.prototype._getFirstListItem=function(t,e,i){return i===void 0&&(i={}),i=Object.assign({filter:e,$cancelKey:"one_by_filter_"+t+"_"+e},i),this._getList(t,1,1,i).then(function(r){var s;if(!(!((s=r==null?void 0:r.items)===null||s===void 0)&&s.length))throw new U({status:404,data:{code:404,message:"The requested resource wasn't found.",data:{}}});return r.items[0]})},n.prototype._create=function(t,e,i){var r=this;return e===void 0&&(e={}),i===void 0&&(i={}),this.client.send(t,{method:"POST",params:i,body:e}).then(function(s){return r.decode(s)})},n.prototype._update=function(t,e,i,r){var s=this;return i===void 0&&(i={}),r===void 0&&(r={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"PATCH",params:r,body:i}).then(function(a){return s.decode(a)})},n.prototype._delete=function(t,e,i){return i===void 0&&(i={}),this.client.send(t+"/"+encodeURIComponent(e),{method:"DELETE",params:i}).then(function(){return!0})},n}(F)),Bt=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.decode=function(t){return new V(t)},Object.defineProperty(n.prototype,"baseCrudPath",{get:function(){return"/api/admins"},enumerable:!1,configurable:!0}),n.prototype.update=function(t,e,i){var r=this;return e===void 0&&(e={}),i===void 0&&(i={}),o.prototype.update.call(this,t,e,i).then(function(s){var a,c;return r.client.authStore.model&&((a=r.client.authStore.model)===null||a===void 0?void 0:a.collectionId)===void 0&&((c=r.client.authStore.model)===null||c===void 0?void 0:c.id)===(s==null?void 0:s.id)&&r.client.authStore.save(r.client.authStore.token,s),s})},n.prototype.delete=function(t,e){var i=this;return e===void 0&&(e={}),o.prototype.delete.call(this,t,e).then(function(r){var s,a;return r&&i.client.authStore.model&&((s=i.client.authStore.model)===null||s===void 0?void 0:s.collectionId)===void 0&&((a=i.client.authStore.model)===null||a===void 0?void 0:a.id)===t&&i.client.authStore.clear(),r})},n.prototype.authResponse=function(t){var e=this.decode((t==null?void 0:t.admin)||{});return(t==null?void 0:t.token)&&(t==null?void 0:t.admin)&&this.client.authStore.save(t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",admin:e})},n.prototype.authWithPassword=function(t,e,i,r){return i===void 0&&(i={}),r===void 0&&(r={}),i=Object.assign({identity:t,password:e},i),this.client.send(this.baseCrudPath+"/auth-with-password",{method:"POST",params:r,body:i,headers:{Authorization:""}}).then(this.authResponse.bind(this))},n.prototype.authRefresh=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send(this.baseCrudPath+"/auth-refresh",{method:"POST",params:e,body:t}).then(this.authResponse.bind(this))},n.prototype.requestPasswordReset=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),e=Object.assign({email:t},e),this.client.send(this.baseCrudPath+"/request-password-reset",{method:"POST",params:i,body:e}).then(function(){return!0})},n.prototype.confirmPasswordReset=function(t,e,i,r,s){return r===void 0&&(r={}),s===void 0&&(s={}),r=Object.assign({token:t,password:e,passwordConfirm:i},r),this.client.send(this.baseCrudPath+"/confirm-password-reset",{method:"POST",params:s,body:r}).then(function(){return!0})},n}(X),Ft=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.load=function(t){o.prototype.load.call(this,t),this.recordId=typeof t.recordId=="string"?t.recordId:"",this.collectionId=typeof t.collectionId=="string"?t.collectionId:"",this.provider=typeof t.provider=="string"?t.provider:"",this.providerId=typeof t.providerId=="string"?t.providerId:""},n}(B),_t=function(o){function n(t,e){var i=o.call(this,t)||this;return i.collectionIdOrName=e,i}return y(n,o),n.prototype.decode=function(t){return new M(t)},Object.defineProperty(n.prototype,"baseCrudPath",{get:function(){return this.baseCollectionPath+"/records"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"baseCollectionPath",{get:function(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)},enumerable:!1,configurable:!0}),n.prototype.subscribeOne=function(t,e){return w(this,void 0,void 0,function(){return S(this,function(i){return console.warn("PocketBase: subscribeOne(recordId, callback) is deprecated. Please replace it with subscribe(recordId, callback)."),[2,this.client.realtime.subscribe(this.collectionIdOrName+"/"+t,e)]})})},n.prototype.subscribe=function(t,e){return w(this,void 0,void 0,function(){var i;return S(this,function(r){if(typeof t=="function")return console.warn("PocketBase: subscribe(callback) is deprecated. Please replace it with subscribe('*', callback)."),[2,this.client.realtime.subscribe(this.collectionIdOrName,t)];if(!e)throw new Error("Missing subscription callback.");if(t==="")throw new Error("Missing topic.");return i=this.collectionIdOrName,t!=="*"&&(i+="/"+t),[2,this.client.realtime.subscribe(i,e)]})})},n.prototype.unsubscribe=function(t){return w(this,void 0,void 0,function(){return S(this,function(e){return t==="*"?[2,this.client.realtime.unsubscribe(this.collectionIdOrName)]:t?[2,this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+t)]:[2,this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)]})})},n.prototype.getFullList=function(t,e){return t===void 0&&(t=200),e===void 0&&(e={}),o.prototype.getFullList.call(this,t,e)},n.prototype.getList=function(t,e,i){return t===void 0&&(t=1),e===void 0&&(e=30),i===void 0&&(i={}),o.prototype.getList.call(this,t,e,i)},n.prototype.getFirstListItem=function(t,e){return e===void 0&&(e={}),o.prototype.getFirstListItem.call(this,t,e)},n.prototype.getOne=function(t,e){return e===void 0&&(e={}),o.prototype.getOne.call(this,t,e)},n.prototype.create=function(t,e){return t===void 0&&(t={}),e===void 0&&(e={}),o.prototype.create.call(this,t,e)},n.prototype.update=function(t,e,i){var r=this;return e===void 0&&(e={}),i===void 0&&(i={}),o.prototype.update.call(this,t,e,i).then(function(s){var a,c;return((a=r.client.authStore.model)===null||a===void 0?void 0:a.collectionId)!==void 0&&((c=r.client.authStore.model)===null||c===void 0?void 0:c.id)===(s==null?void 0:s.id)&&r.client.authStore.save(r.client.authStore.token,s),s})},n.prototype.delete=function(t,e){var i=this;return e===void 0&&(e={}),o.prototype.delete.call(this,t,e).then(function(r){var s,a;return r&&((s=i.client.authStore.model)===null||s===void 0?void 0:s.collectionId)!==void 0&&((a=i.client.authStore.model)===null||a===void 0?void 0:a.id)===t&&i.client.authStore.clear(),r})},n.prototype.authResponse=function(t){var e=this.decode((t==null?void 0:t.record)||{});return this.client.authStore.save(t==null?void 0:t.token,e),Object.assign({},t,{token:(t==null?void 0:t.token)||"",record:e})},n.prototype.listAuthMethods=function(t){return t===void 0&&(t={}),this.client.send(this.baseCollectionPath+"/auth-methods",{method:"GET",params:t}).then(function(e){return Object.assign({},e,{usernamePassword:!!(e!=null&&e.usernamePassword),emailPassword:!!(e!=null&&e.emailPassword),authProviders:Array.isArray(e==null?void 0:e.authProviders)?e==null?void 0:e.authProviders:[]})})},n.prototype.authWithPassword=function(t,e,i,r){var s=this;return i===void 0&&(i={}),r===void 0&&(r={}),i=Object.assign({identity:t,password:e},i),this.client.send(this.baseCollectionPath+"/auth-with-password",{method:"POST",params:r,body:i,headers:{Authorization:""}}).then(function(a){return s.authResponse(a)})},n.prototype.authWithOAuth2=function(t,e,i,r,s,a,c){var l=this;return s===void 0&&(s={}),a===void 0&&(a={}),c===void 0&&(c={}),a=Object.assign({provider:t,code:e,codeVerifier:i,redirectUrl:r,createData:s},a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",{method:"POST",params:c,body:a}).then(function(u){return l.authResponse(u)})},n.prototype.authRefresh=function(t,e){var i=this;return t===void 0&&(t={}),e===void 0&&(e={}),this.client.send(this.baseCollectionPath+"/auth-refresh",{method:"POST",params:e,body:t}).then(function(r){return i.authResponse(r)})},n.prototype.requestPasswordReset=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),e=Object.assign({email:t},e),this.client.send(this.baseCollectionPath+"/request-password-reset",{method:"POST",params:i,body:e}).then(function(){return!0})},n.prototype.confirmPasswordReset=function(t,e,i,r,s){return r===void 0&&(r={}),s===void 0&&(s={}),r=Object.assign({token:t,password:e,passwordConfirm:i},r),this.client.send(this.baseCollectionPath+"/confirm-password-reset",{method:"POST",params:s,body:r}).then(function(){return!0})},n.prototype.requestVerification=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),e=Object.assign({email:t},e),this.client.send(this.baseCollectionPath+"/request-verification",{method:"POST",params:i,body:e}).then(function(){return!0})},n.prototype.confirmVerification=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),e=Object.assign({token:t},e),this.client.send(this.baseCollectionPath+"/confirm-verification",{method:"POST",params:i,body:e}).then(function(){return!0})},n.prototype.requestEmailChange=function(t,e,i){return e===void 0&&(e={}),i===void 0&&(i={}),e=Object.assign({newEmail:t},e),this.client.send(this.baseCollectionPath+"/request-email-change",{method:"POST",params:i,body:e}).then(function(){return!0})},n.prototype.confirmEmailChange=function(t,e,i,r){return i===void 0&&(i={}),r===void 0&&(r={}),i=Object.assign({token:t,password:e},i),this.client.send(this.baseCollectionPath+"/confirm-email-change",{method:"POST",params:r,body:i}).then(function(){return!0})},n.prototype.listExternalAuths=function(t,e){return e===void 0&&(e={}),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths",{method:"GET",params:e}).then(function(i){var r=[];if(Array.isArray(i))for(var s=0,a=i;s<a.length;s++){var c=a[s];r.push(new Ft(c))}return r})},n.prototype.unlinkExternalAuth=function(t,e,i){return i===void 0&&(i={}),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(t)+"/external-auths/"+encodeURIComponent(e),{method:"DELETE",params:i}).then(function(){return!0})},n}(X),Dt=function(){function o(n){n===void 0&&(n={}),this.load(n||{})}return o.prototype.load=function(n){this.id=n.id!==void 0?n.id:"",this.name=n.name!==void 0?n.name:"",this.type=n.type!==void 0?n.type:"text",this.system=!!n.system,this.required=!!n.required,this.unique=!!n.unique,this.options=typeof n.options=="object"&&n.options!==null?n.options:{}},o}(),Nt=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.load=function(t){o.prototype.load.call(this,t),this.system=!!t.system,this.name=typeof t.name=="string"?t.name:"",this.type=typeof t.type=="string"?t.type:"base",this.options=t.options!==void 0?t.options:{},this.listRule=typeof t.listRule=="string"?t.listRule:null,this.viewRule=typeof t.viewRule=="string"?t.viewRule:null,this.createRule=typeof t.createRule=="string"?t.createRule:null,this.updateRule=typeof t.updateRule=="string"?t.updateRule:null,this.deleteRule=typeof t.deleteRule=="string"?t.deleteRule:null,t.schema=Array.isArray(t.schema)?t.schema:[],this.schema=[];for(var e=0,i=t.schema;e<i.length;e++){var r=i[e];this.schema.push(new Dt(r))}},Object.defineProperty(n.prototype,"isBase",{get:function(){return this.type==="base"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isAuth",{get:function(){return this.type==="auth"},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSingle",{get:function(){return this.type==="single"},enumerable:!1,configurable:!0}),n}(B),Mt=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.decode=function(t){return new Nt(t)},Object.defineProperty(n.prototype,"baseCrudPath",{get:function(){return"/api/collections"},enumerable:!1,configurable:!0}),n.prototype.import=function(t,e,i){return e===void 0&&(e=!1),i===void 0&&(i={}),w(this,void 0,void 0,function(){return S(this,function(r){return[2,this.client.send(this.baseCrudPath+"/import",{method:"PUT",params:i,body:{collections:t,deleteMissing:e}}).then(function(){return!0})]})})},n}(X),ft=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.load=function(t){o.prototype.load.call(this,t),t.remoteIp=t.remoteIp||t.ip,this.url=typeof t.url=="string"?t.url:"",this.method=typeof t.method=="string"?t.method:"GET",this.status=typeof t.status=="number"?t.status:200,this.auth=typeof t.auth=="string"?t.auth:"guest",this.remoteIp=typeof t.remoteIp=="string"?t.remoteIp:"",this.userIp=typeof t.userIp=="string"?t.userIp:"",this.referer=typeof t.referer=="string"?t.referer:"",this.userAgent=typeof t.userAgent=="string"?t.userAgent:"",this.meta=typeof t.meta=="object"&&t.meta!==null?t.meta:{}},n}(B),qt=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.getRequestsList=function(t,e,i){return t===void 0&&(t=1),e===void 0&&(e=30),i===void 0&&(i={}),i=Object.assign({page:t,perPage:e},i),this.client.send("/api/logs/requests",{method:"GET",params:i}).then(function(r){var s=[];if(r!=null&&r.items){r.items=(r==null?void 0:r.items)||[];for(var a=0,c=r.items;a<c.length;a++){var l=c[a];s.push(new ft(l))}}return new St((r==null?void 0:r.page)||1,(r==null?void 0:r.perPage)||0,(r==null?void 0:r.totalItems)||0,(r==null?void 0:r.totalPages)||0,s)})},n.prototype.getRequest=function(t,e){return e===void 0&&(e={}),this.client.send("/api/logs/requests/"+encodeURIComponent(t),{method:"GET",params:e}).then(function(i){return new ft(i)})},n.prototype.getRequestsStats=function(t){return t===void 0&&(t={}),this.client.send("/api/logs/requests/stats",{method:"GET",params:t}).then(function(e){return e})},n}(F),Ht=function(o){function n(){var t=o!==null&&o.apply(this,arguments)||this;return t.clientId="",t.eventSource=null,t.subscriptions={},t.lastSentTopics=[],t.maxConnectTimeout=1e4,t.reconnectAttempts=0,t.maxReconnectAttempts=1/0,t.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],t.pendingConnects=[],t}return y(n,o),Object.defineProperty(n.prototype,"isConnected",{get:function(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length},enumerable:!1,configurable:!0}),n.prototype.subscribe=function(t,e){var i;return w(this,void 0,void 0,function(){var r,s=this;return S(this,function(a){switch(a.label){case 0:if(!t)throw new Error("topic must be set.");return r=function(c){var l,u=c;try{l=JSON.parse(u==null?void 0:u.data)}catch{}e(l||{})},this.subscriptions[t]||(this.subscriptions[t]=[]),this.subscriptions[t].push(r),this.isConnected?[3,2]:[4,this.connect()];case 1:return a.sent(),[3,5];case 2:return this.subscriptions[t].length!==1?[3,4]:[4,this.submitSubscriptions()];case 3:return a.sent(),[3,5];case 4:(i=this.eventSource)===null||i===void 0||i.addEventListener(t,r),a.label=5;case 5:return[2,function(){return w(s,void 0,void 0,function(){return S(this,function(c){return[2,this.unsubscribeByTopicAndListener(t,r)]})})}]}})})},n.prototype.unsubscribe=function(t){var e;return w(this,void 0,void 0,function(){var i,r,s;return S(this,function(a){switch(a.label){case 0:if(!this.hasSubscriptionListeners(t))return[2];if(t){for(i=0,r=this.subscriptions[t];i<r.length;i++)s=r[i],(e=this.eventSource)===null||e===void 0||e.removeEventListener(t,s);delete this.subscriptions[t]}else this.subscriptions={};return this.hasSubscriptionListeners()?[3,1]:(this.disconnect(),[3,3]);case 1:return this.hasSubscriptionListeners(t)?[3,3]:[4,this.submitSubscriptions()];case 2:a.sent(),a.label=3;case 3:return[2]}})})},n.prototype.unsubscribeByPrefix=function(t){var e;return w(this,void 0,void 0,function(){var i,r,s,a,c;return S(this,function(l){switch(l.label){case 0:for(r in i=!1,this.subscriptions)if(r.startsWith(t)){for(i=!0,s=0,a=this.subscriptions[r];s<a.length;s++)c=a[s],(e=this.eventSource)===null||e===void 0||e.removeEventListener(r,c);delete this.subscriptions[r]}return i?this.hasSubscriptionListeners()?[4,this.submitSubscriptions()]:[3,2]:[2];case 1:return l.sent(),[3,3];case 2:this.disconnect(),l.label=3;case 3:return[2]}})})},n.prototype.unsubscribeByTopicAndListener=function(t,e){var i;return w(this,void 0,void 0,function(){var r,s;return S(this,function(a){switch(a.label){case 0:if(!Array.isArray(this.subscriptions[t])||!this.subscriptions[t].length)return[2];for(r=!1,s=this.subscriptions[t].length-1;s>=0;s--)this.subscriptions[t][s]===e&&(r=!0,delete this.subscriptions[t][s],this.subscriptions[t].splice(s,1),(i=this.eventSource)===null||i===void 0||i.removeEventListener(t,e));return r?(this.subscriptions[t].length||delete this.subscriptions[t],this.hasSubscriptionListeners()?[3,1]:(this.disconnect(),[3,3])):[2];case 1:return this.hasSubscriptionListeners(t)?[3,3]:[4,this.submitSubscriptions()];case 2:a.sent(),a.label=3;case 3:return[2]}})})},n.prototype.hasSubscriptionListeners=function(t){var e,i;if(this.subscriptions=this.subscriptions||{},t)return!!(!((e=this.subscriptions[t])===null||e===void 0)&&e.length);for(var r in this.subscriptions)if(!((i=this.subscriptions[r])===null||i===void 0)&&i.length)return!0;return!1},n.prototype.submitSubscriptions=function(){return w(this,void 0,void 0,function(){return S(this,function(t){return this.clientId?(this.addAllSubscriptionListeners(),this.lastSentTopics=this.getNonEmptySubscriptionTopics(),[2,this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentTopics},params:{$cancelKey:"realtime_"+this.clientId}}).catch(function(e){if(!(e!=null&&e.isAbort))throw e})]):[2]})})},n.prototype.getNonEmptySubscriptionTopics=function(){var t=[];for(var e in this.subscriptions)this.subscriptions[e].length&&t.push(e);return t},n.prototype.addAllSubscriptionListeners=function(){if(this.eventSource)for(var t in this.removeAllSubscriptionListeners(),this.subscriptions)for(var e=0,i=this.subscriptions[t];e<i.length;e++){var r=i[e];this.eventSource.addEventListener(t,r)}},n.prototype.removeAllSubscriptionListeners=function(){if(this.eventSource)for(var t in this.subscriptions)for(var e=0,i=this.subscriptions[t];e<i.length;e++){var r=i[e];this.eventSource.removeEventListener(t,r)}},n.prototype.connect=function(){return w(this,void 0,void 0,function(){var t=this;return S(this,function(e){return this.reconnectAttempts>0?[2]:[2,new Promise(function(i,r){t.pendingConnects.push({resolve:i,reject:r}),t.pendingConnects.length>1||t.initConnect()})]})})},n.prototype.initConnect=function(){var t=this;this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(function(){t.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildUrl("/api/realtime")),this.eventSource.onerror=function(e){t.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",function(e){var i=e;t.clientId=i==null?void 0:i.lastEventId,t.submitSubscriptions().then(function(){return w(t,void 0,void 0,function(){var r;return S(this,function(s){switch(s.label){case 0:r=3,s.label=1;case 1:return this.hasUnsentSubscriptions()&&r>0?(r--,[4,this.submitSubscriptions()]):[3,3];case 2:return s.sent(),[3,1];case 3:return[2]}})})}).then(function(){for(var r=0,s=t.pendingConnects;r<s.length;r++)s[r].resolve();t.pendingConnects=[],t.reconnectAttempts=0,clearTimeout(t.reconnectTimeoutId),clearTimeout(t.connectTimeoutId)}).catch(function(r){t.clientId="",t.connectErrorHandler(r)})})},n.prototype.hasUnsentSubscriptions=function(){var t=this.getNonEmptySubscriptionTopics();if(t.length!=this.lastSentTopics.length)return!0;for(var e=0,i=t;e<i.length;e++){var r=i[e];if(!this.lastSentTopics.includes(r))return!0}return!1},n.prototype.connectErrorHandler=function(t){var e=this;if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(var i=0,r=this.pendingConnects;i<r.length;i++)r[i].reject(new U(t));this.disconnect()}else{this.disconnect(!0);var s=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(function(){e.initConnect()},s)}},n.prototype.disconnect=function(t){var e;if(t===void 0&&(t=!1),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),(e=this.eventSource)===null||e===void 0||e.close(),this.eventSource=null,this.clientId="",!t){this.reconnectAttempts=0;for(var i=new U(new Error("Realtime disconnected.")),r=0,s=this.pendingConnects;r<s.length;r++)s[r].reject(i);this.pendingConnects=[]}},n}(F),Wt=function(o){function n(){return o!==null&&o.apply(this,arguments)||this}return y(n,o),n.prototype.check=function(t){return t===void 0&&(t={}),this.client.send("/api/health",{method:"GET",params:t})},n}(F),zt=function(){function o(n,t,e){n===void 0&&(n="/"),e===void 0&&(e="en-US"),this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseUrl=n,this.lang=e,this.authStore=t||new Lt,this.admins=new Bt(this),this.collections=new Mt(this),this.logs=new qt(this),this.settings=new Ut(this),this.realtime=new Ht(this),this.health=new Wt(this)}return o.prototype.collection=function(n){return this.recordServices[n]||(this.recordServices[n]=new _t(this,n)),this.recordServices[n]},o.prototype.autoCancellation=function(n){return this.enableAutoCancellation=!!n,this},o.prototype.cancelRequest=function(n){return this.cancelControllers[n]&&(this.cancelControllers[n].abort(),delete this.cancelControllers[n]),this},o.prototype.cancelAllRequests=function(){for(var n in this.cancelControllers)this.cancelControllers[n].abort();return this.cancelControllers={},this},o.prototype.send=function(n,t){var e,i,r,s,a,c,l,u;return w(this,void 0,void 0,function(){var h,f,p,d,m,v=this;return S(this,function(k){return(h=Object.assign({method:"GET"},t)).body&&h.body.constructor.name!=="FormData"&&(typeof h.body!="string"&&(h.body=JSON.stringify(h.body)),((e=h==null?void 0:h.headers)===null||e===void 0?void 0:e["Content-Type"])===void 0&&(h.headers=Object.assign({},h.headers,{"Content-Type":"application/json"}))),((i=h==null?void 0:h.headers)===null||i===void 0?void 0:i["Accept-Language"])===void 0&&(h.headers=Object.assign({},h.headers,{"Accept-Language":this.lang})),((r=this.authStore)===null||r===void 0?void 0:r.token)&&((s=h==null?void 0:h.headers)===null||s===void 0?void 0:s.Authorization)===void 0&&(h.headers=Object.assign({},h.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&((a=h.params)===null||a===void 0?void 0:a.$autoCancel)!==!1&&(f=((c=h.params)===null||c===void 0?void 0:c.$cancelKey)||(h.method||"GET")+n,this.cancelRequest(f),p=new AbortController,this.cancelControllers[f]=p,h.signal=p.signal),(l=h.params)===null||l===void 0||delete l.$autoCancel,(u=h.params)===null||u===void 0||delete u.$cancelKey,d=this.buildUrl(n),h.params!==void 0&&((m=this.serializeQueryParams(h.params))&&(d+=(d.includes("?")?"&":"?")+m),delete h.params),this.beforeSend&&(h=Object.assign({},this.beforeSend(d,h))),[2,fetch(d,h).then(function(O){return w(v,void 0,void 0,function(){var C;return S(this,function(P){switch(P.label){case 0:C={},P.label=1;case 1:return P.trys.push([1,3,,4]),[4,O.json()];case 2:return C=P.sent(),[3,4];case 3:return P.sent(),[3,4];case 4:if(this.afterSend&&(C=this.afterSend(O,C)),O.status>=400)throw new U({url:O.url,status:O.status,data:C});return[2,C]}})})}).catch(function(O){throw new U(O)})]})})},o.prototype.getFileUrl=function(n,t,e){e===void 0&&(e={});var i=[];i.push("api"),i.push("files"),i.push(encodeURIComponent(n.collectionId||n.collectionName)),i.push(encodeURIComponent(n.id)),i.push(encodeURIComponent(t));var r=this.buildUrl(i.join("/"));if(Object.keys(e).length){var s=new URLSearchParams(e);r+=(r.includes("?")?"&":"?")+s}return r},o.prototype.buildUrl=function(n){var t=this.baseUrl+(this.baseUrl.endsWith("/")?"":"/");return n&&(t+=n.startsWith("/")?n.substring(1):n),t},o.prototype.serializeQueryParams=function(n){var t=[];for(var e in n)if(n[e]!==null){var i=n[e],r=encodeURIComponent(e);if(Array.isArray(i))for(var s=0,a=i;s<a.length;s++){var c=a[s];t.push(r+"="+encodeURIComponent(c))}else i instanceof Date?t.push(r+"="+encodeURIComponent(i.toISOString())):typeof i!==null&&typeof i=="object"?t.push(r+"="+encodeURIComponent(JSON.stringify(i))):t.push(r+"="+encodeURIComponent(i))}return t.join("&")},o}();const Gt="https://pocket.services.samadhiyogaidaho.com/",I=new zt(Gt);T.admin=async()=>await I.admins.authWithPassword("daniel97.le@gmail.com","2MSOBk4SXEY4yYuhsxuQ3atZiVSaShtE");/*!
 * Compressor.js v1.1.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-10-05T02:32:40.212Z
 */function vt(o,n){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(o);n&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),t.push.apply(t,e)}return t}function N(o){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?vt(Object(t),!0).forEach(function(e){$t(o,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):vt(Object(t)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(t,e))})}return o}function Jt(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}function mt(o,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}function Kt(o,n,t){return n&&mt(o.prototype,n),t&&mt(o,t),o}function $t(o,n,t){return n in o?Object.defineProperty(o,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[n]=t,o}function q(){return q=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(o[e]=t[e])}return o},q.apply(this,arguments)}var Ct={exports:{}};(function(o){typeof window>"u"||function(n){var t=n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype,e=n.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),i=e&&n.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),r=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,s=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,a=(e||r)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(c){var l,u,h,f,p,d,m,v,k;if(l=c.match(s),!l)throw new Error("invalid data URI");for(u=l[2]?l[1]:"text/plain"+(l[3]||";charset=US-ASCII"),h=!!l[4],f=c.slice(l[0].length),h?p=atob(f):p=decodeURIComponent(f),d=new ArrayBuffer(p.length),m=new Uint8Array(d),v=0;v<p.length;v+=1)m[v]=p.charCodeAt(v);return e?new Blob([i?m:d],{type:u}):(k=new r,k.append(d),k.getBlob(u))};n.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(c,l,u){var h=this;setTimeout(function(){u&&t.toDataURL&&a?c(a(h.toDataURL(l,u))):c(h.mozGetAsFile("blob",l))})}:t.toDataURL&&a&&(t.msToBlob?t.toBlob=function(c,l,u){var h=this;setTimeout(function(){(l&&l!=="image/png"||u)&&t.toDataURL&&a?c(a(h.toDataURL(l,u))):c(h.msToBlob(l))})}:t.toBlob=function(c,l,u){var h=this;setTimeout(function(){c(a(h.toDataURL(l,u)))})})),o.exports?o.exports=a:n.dataURLtoBlob=a}(window)})(Ct);var Vt=Ct.exports,Xt=function(n){return typeof Blob>"u"?!1:n instanceof Blob||Object.prototype.toString.call(n)==="[object Blob]"},bt={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},Yt=typeof window<"u"&&typeof window.document<"u",R=Yt?window:{},H=function(n){return n>0&&n<1/0},Qt=Array.prototype.slice;function Zt(o){return Array.from?Array.from(o):Qt.call(o)}var te=/^image\/.+$/;function $(o){return te.test(o)}function ee(o){var n=$(o)?o.substr(6):"";return n==="jpeg"&&(n="jpg"),".".concat(n)}var Ot=String.fromCharCode;function ne(o,n,t){var e="",i;for(t+=n,i=n;i<t;i+=1)e+=Ot(o.getUint8(i));return e}var ie=R.btoa;function re(o,n){for(var t=[],e=8192,i=new Uint8Array(o);i.length>0;)t.push(Ot.apply(null,Zt(i.subarray(0,e)))),i=i.subarray(e);return"data:".concat(n,";base64,").concat(ie(t.join("")))}function oe(o){var n=new DataView(o),t;try{var e,i,r;if(n.getUint8(0)===255&&n.getUint8(1)===216)for(var s=n.byteLength,a=2;a+1<s;){if(n.getUint8(a)===255&&n.getUint8(a+1)===225){i=a;break}a+=1}if(i){var c=i+4,l=i+10;if(ne(n,c,4)==="Exif"){var u=n.getUint16(l);if(e=u===18761,(e||u===19789)&&n.getUint16(l+2,e)===42){var h=n.getUint32(l+4,e);h>=8&&(r=l+h)}}}if(r){var f=n.getUint16(r,e),p,d;for(d=0;d<f;d+=1)if(p=r+d*12+2,n.getUint16(p,e)===274){p+=8,t=n.getUint16(p,e),n.setUint16(p,1,e);break}}}catch{t=1}return t}function se(o){var n=0,t=1,e=1;switch(o){case 2:t=-1;break;case 3:n=-180;break;case 4:e=-1;break;case 5:n=90,e=-1;break;case 6:n=90;break;case 7:n=90,t=-1;break;case 8:n=-90;break}return{rotate:n,scaleX:t,scaleY:e}}var ae=/\.\d*(?:0|9){12}\d*$/;function gt(o){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ae.test(o)?Math.round(o*n)/n:o}function L(o){var n=o.aspectRatio,t=o.height,e=o.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",r=H(e),s=H(t);if(r&&s){var a=t*n;(i==="contain"||i==="none")&&a>e||i==="cover"&&a<e?t=e/n:e=t*n}else r?t=e/n:s&&(e=t*n);return{width:e,height:t}}var ce=R.ArrayBuffer,yt=R.FileReader,A=R.URL||R.webkitURL,ue=/\.\w+$/,le=R.Compressor,he=function(){function o(n,t){Jt(this,o),this.file=n,this.image=new Image,this.options=N(N({},bt),t),this.aborted=!1,this.result=null,this.init()}return Kt(o,[{key:"init",value:function(){var t=this,e=this.file,i=this.options;if(!Xt(e)){this.fail(new Error("The first argument must be a File or Blob object."));return}var r=e.type;if(!$(r)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!A||!yt){this.fail(new Error("The current browser does not support image compression."));return}if(ce||(i.checkOrientation=!1),A&&!i.checkOrientation)this.load({url:A.createObjectURL(e)});else{var s=new yt,a=i.checkOrientation&&r==="image/jpeg";this.reader=s,s.onload=function(c){var l=c.target,u=l.result,h={};if(a){var f=oe(u);f>1||!A?(h.url=re(u,r),f>1&&q(h,se(f))):h.url=A.createObjectURL(e)}else h.url=u;t.load(h)},s.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},s.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},s.onloadend=function(){t.reader=null},a?s.readAsArrayBuffer(e):s.readAsDataURL(e)}}},{key:"load",value:function(t){var e=this,i=this.file,r=this.image;r.onload=function(){e.draw(N(N({},t),{},{naturalWidth:r.naturalWidth,naturalHeight:r.naturalHeight}))},r.onabort=function(){e.fail(new Error("Aborted to load the image."))},r.onerror=function(){e.fail(new Error("Failed to load the image."))},R.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(R.navigator.userAgent)&&(r.crossOrigin="anonymous"),r.alt=i.name,r.src=t.url}},{key:"draw",value:function(t){var e=this,i=t.naturalWidth,r=t.naturalHeight,s=t.rotate,a=s===void 0?0:s,c=t.scaleX,l=c===void 0?1:c,u=t.scaleY,h=u===void 0?1:u,f=this.file,p=this.image,d=this.options,m=document.createElement("canvas"),v=m.getContext("2d"),k=Math.abs(a)%180===90,O=(d.resize==="contain"||d.resize==="cover")&&H(d.width)&&H(d.height),C=Math.max(d.maxWidth,0)||1/0,P=Math.max(d.maxHeight,0)||1/0,j=Math.max(d.minWidth,0)||0,x=Math.max(d.minHeight,0)||0,E=i/r,b=d.width,g=d.height;if(k){var Y=[P,C];C=Y[0],P=Y[1];var Q=[x,j];j=Q[0],x=Q[1];var Z=[g,b];b=Z[0],g=Z[1]}O&&(E=b/g);var tt=L({aspectRatio:E,width:C,height:P},"contain");C=tt.width,P=tt.height;var et=L({aspectRatio:E,width:j,height:x},"cover");if(j=et.width,x=et.height,O){var nt=L({aspectRatio:E,width:b,height:g},d.resize);b=nt.width,g=nt.height}else{var it=L({aspectRatio:E,width:b,height:g}),rt=it.width;b=rt===void 0?i:rt;var ot=it.height;g=ot===void 0?r:ot}b=Math.floor(gt(Math.min(Math.max(b,j),C))),g=Math.floor(gt(Math.min(Math.max(g,x),P)));var Pt=-b/2,Tt=-g/2,It=b,Rt=g,W=[];if(O){var st=0,at=0,z=i,G=r,ct=L({aspectRatio:E,width:i,height:r},{contain:"cover",cover:"contain"}[d.resize]);z=ct.width,G=ct.height,st=(i-z)/2,at=(r-G)/2,W.push(st,at,z,G)}if(W.push(Pt,Tt,It,Rt),k){var ut=[g,b];b=ut[0],g=ut[1]}m.width=b,m.height=g,$(d.mimeType)||(d.mimeType=f.type);var lt="transparent";if(f.size>d.convertSize&&d.convertTypes.indexOf(d.mimeType)>=0&&(d.mimeType="image/jpeg"),d.mimeType==="image/jpeg"&&(lt="#fff"),v.fillStyle=lt,v.fillRect(0,0,b,g),d.beforeDraw&&d.beforeDraw.call(this,v,m),!this.aborted&&(v.save(),v.translate(b/2,g/2),v.rotate(a*Math.PI/180),v.scale(l,h),v.drawImage.apply(v,[p].concat(W)),v.restore(),d.drew&&d.drew.call(this,v,m),!this.aborted)){var ht=function(kt){e.aborted||e.done({naturalWidth:i,naturalHeight:r,result:kt})};m.toBlob?m.toBlob(ht,d.mimeType,d.quality):ht(Vt(m.toDataURL(d.mimeType,d.quality)))}}},{key:"done",value:function(t){var e=t.naturalWidth,i=t.naturalHeight,r=t.result,s=this.file,a=this.image,c=this.options;if(A&&!c.checkOrientation&&A.revokeObjectURL(a.src),r)if(c.strict&&r.size>s.size&&c.mimeType===s.type&&!(c.width>e||c.height>i||c.minWidth>e||c.minHeight>i||c.maxWidth<e||c.maxHeight<i))r=s;else{var l=new Date;r.lastModified=l.getTime(),r.lastModifiedDate=l,r.name=s.name,r.name&&r.type!==s.type&&(r.name=r.name.replace(ue,ee(r.type)))}else r=s;this.result=r,c.success&&c.success.call(this,r)}},{key:"fail",value:function(t){var e=this.options;if(e.error)e.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=le,o}},{key:"setDefaults",value:function(t){q(bt,t)}}]),o}();class de{async getFiles(){const n=await I.collection("aug22Retreat").getFullList();_.log(n);let t=[];n.forEach(e=>{t.push(e.url)})}async uploadFile(n,t){const e=Array.from(n.target.files);T.loading=e.length;for await(const i of e){let r=new FormData,s=await this.compress(i);r.append("file",s);const a=await this.createFile(r,t.name),c=await I.getFileUrl(a,a.file,{thumb:"500x500"});await I.collection(t.name).update(a.id,{url:c}),_.log({uncompressed:i.size/1e6+"mb",compressed:s.size/1e3+"kb",url:c}),T.uploadedImgs.push(c),T.loading--}}async compress(n){let t=null;return await new Promise((e,i)=>{new he(n,{quality:.5,success(r){t=r,e()}})}),t}async createFile(n,t){try{return await I.collection(t).create(n)}catch(e){At.error(e,"please contact an admin")}}async getPastRetreats(){(await I.collection("aug22Retreat").getFullList()).forEach(t=>T.aug22RetreatImages.push(t.url)),_.log(T.aug22RetreatImages)}async createCollection(n){const t=await I.collections.getOne("default"),e=await I.collections.create({name:n,type:t.type,schema:t.schema});T.collections=[...T.collections,e]}async getCollections(){let n=await(await I.collections.getList()).items;n=n.filter(t=>t.name!="users"),_.log(n),T.collections=n}}const ve=new de;export{ve as pocketBaseService};
